{
  "name": "coverage-threshold-tuning",
  "version": "1.0.0",
  "category": "tooling",
  "description": "Tune pytest coverage thresholds to match actual coverage baselines and avoid CI failures",
  "triggers": [
    "Coverage is failing at",
    "Set realistic coverage threshold",
    "CI coverage check is too strict",
    "Coverage failure: total of",
    "fail-under threshold"
  ],
  "tags": [
    "pytest",
    "coverage",
    "ci-cd",
    "threshold",
    "pixi",
    "github-actions"
  ],
  "created": "2026-02-15",
  "source": {
    "issue": "#671",
    "pr": "#689",
    "session": "2026-02-15"
  },
  "outcomes": {
    "success": true,
    "metrics": {
      "initial_threshold": "80%",
      "actual_coverage": "72.89%",
      "final_threshold": "72%",
      "margin": "0.89%"
    }
  },
  "key_learnings": [
    "Always check actual coverage before setting thresholds",
    "Build in margin of safety (at least 1% below actual coverage)",
    "Coverage threshold must be updated in 3 places: pyproject.toml (2x) and CI workflow",
    "Regenerate pixi.lock after modifying pixi.toml",
    "Document incremental improvement path to avoid future threshold creep"
  ],
  "failed_attempts": [
    "Setting threshold to 80% without checking actual coverage",
    "Setting threshold to 73% (too close to 72.89% actual)",
    "Forgetting to regenerate pixi.lock after pixi.toml changes",
    "Only updating threshold in one location (pyproject.toml)"
  ],
  "related_skills": [
    "pytest-coverage-threshold-config",
    "pre-commit-maintenance",
    "fix-failing-ci-prs"
  ]
}
