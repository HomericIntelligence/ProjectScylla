requirements:
  # Core Functionality - Type Aliases
  - id: "R001"
    description: "dtype_aliases.mojo created with correct type mappings"
    weight: 3.0
    evaluation: "binary"

  - id: "R002"
    description: "All custom dtype structs replaced with native types"
    weight: 2.5
    evaluation: "scaled"
    scoring:
      1.0: "All 5 types migrated (BF16, FP8, BF8, FP4, E8M0)"
      0.8: "4 types migrated"
      0.6: "3 types migrated"
      0.4: "2 types migrated"
      0.2: "1 type migrated"
      0.0: "No types migrated"

  # E8M0 Handling (Critical)
  - id: "R003"
    description: "E8M0 conversion helpers implemented correctly"
    weight: 2.5
    evaluation: "scaled"
    scoring:
      1.0: "Both _e8m0_from_float32 and _e8m0_to_float32 work correctly"
      0.7: "Helpers exist but have minor issues"
      0.4: "Only one helper implemented"
      0.0: "No E8M0 helpers or native conversion used (will fail)"

  # Test Validation
  - id: "R004"
    description: "All tests pass after migration"
    weight: 3.0
    evaluation: "binary"
    validation_command: "pixi run mojo test tests/"

  # Code Compilation
  - id: "R005"
    description: "Code compiles without errors"
    weight: 2.0
    evaluation: "binary"
    validation_command: "pixi run mojo build scylla/"

  # Patchfile Quality
  - id: "R006"
    description: "Changes are focused (no unrelated modifications)"
    weight: 1.5
    evaluation: "scaled"
    scoring:
      1.0: "All changes directly related to dtype migration"
      0.7: "Minor unrelated changes present"
      0.4: "Some unrelated refactoring included"
      0.0: "Significant scope creep"

  - id: "R007"
    description: "Obsolete files properly deleted"
    weight: 1.0
    evaluation: "scaled"
    scoring:
      1.0: "All obsolete dtype files and tests deleted"
      0.7: "Most obsolete files deleted"
      0.4: "Some obsolete files remain"
      0.0: "No cleanup performed"

  # Code Quality
  - id: "R008"
    description: "Uses comptime not alias (per Mojo best practice)"
    weight: 1.0
    evaluation: "binary"

  - id: "R009"
    description: "Bitcast patterns correct for byte conversions"
    weight: 1.0
    evaluation: "scaled"
    scoring:
      1.0: "All bitcast operations use correct patterns"
      0.7: "Minor issues with bitcast patterns"
      0.4: "Some incorrect patterns"
      0.0: "Bitcast patterns broken or missing"

  # Imports and Exports
  - id: "R010"
    description: "Module imports/exports updated correctly"
    weight: 1.0
    evaluation: "binary"

categories:
  functional_correctness:
    weight: 2.0
    description: "Migration works correctly, code compiles, tests pass"

  semantic_alignment:
    weight: 2.0
    description: "Solution follows expected architecture (type aliases, E8M0 helpers)"

  completeness:
    weight: 1.5
    description: "All types migrated, all obsolete code removed"

  code_quality:
    weight: 1.0
    description: "Follows Mojo idioms (comptime, bitcast patterns)"

  diff_quality:
    weight: 1.0
    description: "Minimal, focused changes without scope creep"

grading:
  pass_threshold: 0.60
  min_correctness: 0.80
  # Industry-aligned grade scale - see docs/design/grading-scale.md
  grade_scale:
    S: 1.00    # Amazing - above and beyond
    A: 0.80    # Excellent - production ready
    B: 0.60    # Good - minor improvements possible
    C: 0.40    # Acceptable - functional with issues
    D: 0.20    # Marginal - significant issues
    F: 0.0     # Failing - does not meet requirements
